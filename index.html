<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç»å…¸è¯µè¯» - å¤éŸµä»Šå£°</title>
    <link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Serif+SC:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* ä¼ ç»Ÿå¤å…¸æ¸©å’Œè‰²å½©ç³»ç»Ÿ */
            --warm-white: #FFF8F0;        /* è±¡ç‰™ç™½ - ä¸»èƒŒæ™¯ */
            --ivory-white: #FDF6E3;       /* ç±³ç™½ - å¡ç‰‡èƒŒæ™¯ */
            --warm-yellow: #F4E4BC;       /* æš–é»„ - é‡ç‚¹é«˜äº® */
            --light-gold: #E6D3A3;        /* æ·¡é‡‘ - è£…é¥°è¾¹æ¡† */
            --deep-red: #8B2635;          /* æ·±çº¢ - ä¸»æ ‡é¢˜ã€é‡è¦æŒ‰é’® */
            --wine-red: #A83A4A;          /* é…’çº¢ - å¼ºè°ƒè‰² */
            --ink-black: #2D1B14;         /* å¢¨é»‘ - æ­£æ–‡ */
            --charcoal: #4A3F35;          /* å¢¨ç° - æ¬¡è¦æ–‡å­— */
            --soft-green: #7D8471;        /* å¢¨ç»¿ - è¿›åº¦æ¡ */
            --rose-gold: #C19A6B;         /* ç«ç‘°é‡‘ - å®Œæˆæ ‡è®° */
            
            /* é˜´å½±é¢œè‰² */
            --shadow-warm: rgba(139, 38, 53, 0.1);
            --shadow-gold: rgba(197, 154, 107, 0.15);
            
            /* é—´è·ç³»ç»Ÿ */
            --space-xs: 8px;
            --space-sm: 12px;
            --space-md: 16px;
            --space-lg: 24px;
            --space-xl: 32px;
            --space-xxl: 48px;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Noto Serif SC', serif;
            background: linear-gradient(135deg, var(--warm-white) 0%, var(--ivory-white) 100%);
            color: var(--ink-black);
            line-height: 1.8;
            min-height: 100vh;
            position: relative;
        }

        /* ä¼ ç»Ÿè£…é¥°æ€§èƒŒæ™¯çº¹ç† */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 20% 20%, rgba(197, 154, 107, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(139, 38, 53, 0.03) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(197, 154, 107, 0.02) 0%, transparent 30%);
            pointer-events: none;
            z-index: -1;
        }

        /* ä¸»å®¹å™¨ */
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: var(--space-md);
            min-height: 100vh;
        }

        /* é¡µé¢å¤´éƒ¨ */
        .header {
            text-align: center;
            padding: var(--space-lg) 0;
            background: var(--ivory-white);
            border-radius: 20px;
            box-shadow: 0 4px 20px var(--shadow-warm);
            margin-bottom: var(--space-lg);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--deep-red), var(--warm-yellow), var(--deep-red));
        }

        .title {
            font-family: 'Ma Shan Zheng', cursive;
            font-size: clamp(28px, 6vw, 42px);
            color: var(--deep-red);
            margin-bottom: var(--space-sm);
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            position: relative;
        }

        .subtitle {
            font-size: clamp(14px, 3vw, 18px);
            color: var(--charcoal);
            font-weight: 300;
            letter-spacing: 2px;
        }

        /* å¯¼èˆªæŒ‰é’® */
        .nav-tabs {
            display: flex;
            background: var(--ivory-white);
            border-radius: 15px;
            padding: var(--space-xs);
            margin-bottom: var(--space-lg);
            box-shadow: 0 2px 10px var(--shadow-warm);
        }

        .nav-tab {
            flex: 1;
            padding: var(--space-sm) var(--space-md);
            text-align: center;
            background: transparent;
            border: none;
            border-radius: 10px;
            font-family: 'Noto Serif SC', serif;
            font-size: 14px;
            color: var(--charcoal);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .nav-tab.active {
            background: linear-gradient(135deg, var(--warm-yellow), var(--light-gold));
            color: var(--deep-red);
            font-weight: 600;
            box-shadow: 0 2px 8px var(--shadow-gold);
        }

        .nav-tab:hover:not(.active) {
            background: rgba(197, 154, 107, 0.1);
        }

        /* é¡µé¢å†…å®¹ */
        .page {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ä¹¦ç±ç®¡ç†å¡ç‰‡ */
        .book-card {
            background: var(--ivory-white);
            border-radius: 18px;
            padding: var(--space-lg);
            margin-bottom: var(--space-md);
            box-shadow: 0 4px 20px var(--shadow-warm);
            border: 2px solid transparent;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .book-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(197, 154, 107, 0.1), transparent);
            transition: left 0.5s ease;
        }

        .book-card:hover::before {
            left: 100%;
        }

        .book-card:hover {
            border-color: var(--light-gold);
            transform: translateY(-2px);
            box-shadow: 0 6px 25px var(--shadow-gold);
        }

        .book-title {
            font-family: 'Ma Shan Zheng', cursive;
            font-size: 24px;
            color: var(--deep-red);
            margin-bottom: var(--space-sm);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .book-stats {
            display: flex;
            gap: var(--space-md);
            margin-bottom: var(--space-md);
            flex-wrap: wrap;
        }

        .stat-item {
            background: var(--warm-white);
            padding: var(--space-xs) var(--space-sm);
            border-radius: 8px;
            font-size: 12px;
            color: var(--charcoal);
            border: 1px solid var(--light-gold);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--warm-white);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: var(--space-md);
            border: 1px solid var(--light-gold);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--soft-green), var(--rose-gold));
            border-radius: 4px;
            transition: width 0.5s ease;
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .book-actions {
            display: flex;
            gap: var(--space-sm);
        }

        .btn {
            padding: var(--space-sm) var(--space-md);
            border: none;
            border-radius: 10px;
            font-family: 'Noto Serif SC', serif;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--deep-red), var(--wine-red));
            color: white;
            box-shadow: 0 2px 10px var(--shadow-warm);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 15px var(--shadow-warm);
        }

        .btn-secondary {
            background: var(--warm-white);
            color: var(--charcoal);
            border: 1px solid var(--light-gold);
        }

        .btn-secondary:hover {
            background: var(--light-gold);
            color: var(--deep-red);
        }

        /* ç« èŠ‚é˜…è¯»ç•Œé¢ */
        .reading-interface {
            background: var(--ivory-white);
            border-radius: 18px;
            padding: var(--space-lg);
            box-shadow: 0 4px 20px var(--shadow-warm);
            min-height: 60vh;
        }

        .chapter-header {
            text-align: center;
            margin-bottom: var(--space-lg);
            padding-bottom: var(--space-md);
            border-bottom: 2px solid var(--light-gold);
        }

        .chapter-title {
            font-family: 'Ma Shan Zheng', cursive;
            font-size: 28px;
            color: var(--deep-red);
            margin-bottom: var(--space-sm);
        }

        .chapter-info {
            display: flex;
            justify-content: center;
            gap: var(--space-md);
            margin-bottom: var(--space-md);
        }

        .chapter-stat {
            background: var(--warm-white);
            padding: var(--space-xs) var(--space-sm);
            border-radius: 8px;
            font-size: 14px;
            color: var(--charcoal);
            border: 1px solid var(--light-gold);
        }

        .reading-content {
            background: var(--warm-white);
            padding: var(--space-lg);
            border-radius: 12px;
            margin-bottom: var(--space-lg);
            border: 2px solid var(--light-gold);
            position: relative;
            min-height: 200px;
        }

        .reading-text {
            font-size: 18px;
            line-height: 2;
            color: var(--ink-black);
            text-align: center;
            font-family: 'Noto Serif SC', serif;
        }

        /* å°ç« æŒ‰é’® - ç‹¬ç‰¹è®¾è®¡ */
        .stamp-button {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: radial-gradient(circle, var(--deep-red) 0%, var(--wine-red) 100%);
            border: 3px solid var(--warm-yellow);
            color: var(--warm-yellow);
            font-family: 'Ma Shan Zheng', cursive;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 4px 15px var(--shadow-warm);
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto var(--space-lg);
        }

        .stamp-button:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px var(--shadow-warm);
        }

        .stamp-button:active {
            transform: scale(0.95);
        }

        .stamp-button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255,255,255,0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: all 0.3s ease;
        }

        .stamp-button:active::before {
            width: 100px;
            height: 100px;
        }

        /* å®Œæˆåº†ç¥åŠ¨ç”» */
        .completion-celebration {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
            display: none;
        }

        .completion-celebration.show {
            display: block;
        }

        .celebration-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-family: 'Ma Shan Zheng', cursive;
            font-size: clamp(32px, 8vw, 48px);
            color: var(--deep-red);
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            animation: celebrate 3s ease-out;
        }

        @keyframes celebrate {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
            20% { opacity: 1; transform: translate(-50%, -50%) scale(1.2); }
            40% { transform: translate(-50%, -50%) scale(0.9); }
            60% { transform: translate(-50%, -50%) scale(1.1); }
            100% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
        }

        .golden-particles {
            position: absolute;
            width: 100%;
            height: 100%;
        }

        .golden-particles::before,
        .golden-particles::after {
            content: '';
            position: absolute;
            width: 6px;
            height: 6px;
            background: var(--warm-yellow);
            border-radius: 50%;
            animation: float 3s ease-out infinite;
        }

        .golden-particles::before {
            top: 20%;
            left: 20%;
            animation-delay: 0s;
        }

        .golden-particles::after {
            top: 20%;
            right: 20%;
            animation-delay: 1s;
        }

        @keyframes float {
            0% { 
                opacity: 0; 
                transform: translateY(0) scale(0); 
            }
            50% { 
                opacity: 1; 
                transform: translateY(-100px) scale(1); 
            }
            100% { 
                opacity: 0; 
                transform: translateY(-200px) scale(0); 
            }
        }

        /* è¡¨å•æ ·å¼ */
        .form-group {
            margin-bottom: var(--space-md);
        }

        .form-label {
            display: block;
            margin-bottom: var(--space-xs);
            color: var(--charcoal);
            font-weight: 600;
        }

        .form-input {
            width: 100%;
            padding: var(--space-sm) var(--space-md);
            border: 2px solid var(--light-gold);
            border-radius: 8px;
            font-family: 'Noto Serif SC', serif;
            font-size: 16px;
            background: var(--warm-white);
            transition: border-color 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--deep-red);
            box-shadow: 0 0 0 3px rgba(139, 38, 53, 0.1);
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
            line-height: 1.8;
        }

        /* ç« èŠ‚åˆ—è¡¨ */
        .chapter-list {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid var(--light-gold);
            border-radius: 8px;
            background: var(--warm-white);
        }

        .chapter-item {
            padding: var(--space-md);
            border-bottom: 1px solid var(--light-gold);
            cursor: pointer;
            transition: background 0.3s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chapter-item:last-child {
            border-bottom: none;
        }

        .chapter-item:hover {
            background: rgba(197, 154, 107, 0.1);
        }

        .chapter-item.completed {
            background: rgba(197, 154, 107, 0.2);
        }

        .chapter-name {
            flex: 1;
            color: var(--ink-black);
            font-weight: 500;
        }

        .chapter-count {
            background: var(--soft-green);
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }

        /* ç»Ÿè®¡é¢æ¿ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-md);
            margin-bottom: var(--space-lg);
        }

        .stat-card {
            background: var(--ivory-white);
            padding: var(--space-lg);
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 2px 10px var(--shadow-warm);
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            border-color: var(--light-gold);
            transform: translateY(-2px);
        }

        .stat-number {
            font-family: 'Ma Shan Zheng', cursive;
            font-size: 32px;
            color: var(--deep-red);
            margin-bottom: var(--space-xs);
        }

        .stat-label {
            color: var(--charcoal);
            font-size: 14px;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .container {
                padding: var(--space-sm);
            }

            .nav-tabs {
                flex-direction: column;
                gap: var(--space-xs);
            }

            .nav-tab {
                padding: var(--space-sm);
            }

            .book-stats {
                flex-direction: column;
                gap: var(--space-xs);
            }

            .book-actions {
                flex-direction: column;
            }

            .chapter-info {
                flex-direction: column;
                gap: var(--space-xs);
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .reading-content {
                padding: var(--space-md);
            }

            .reading-text {
                font-size: 16px;
            }

            .stamp-button {
                width: 70px;
                height: 70px;
                font-size: 14px;
            }
        }

        @media (max-width: 480px) {
            .header {
                padding: var(--space-md);
                margin-bottom: var(--space-md);
            }

            .book-card {
                padding: var(--space-md);
            }

            .reading-interface {
                padding: var(--space-md);
            }

            .reading-text {
                font-size: 15px;
                line-height: 1.6;
            }

            .stamp-button {
                width: 60px;
                height: 60px;
                font-size: 12px;
            }
        }

        /* æ»šåŠ¨æ¡æ ·å¼ */
        .chapter-list::-webkit-scrollbar {
            width: 6px;
        }

        .chapter-list::-webkit-scrollbar-track {
            background: var(--warm-white);
            border-radius: 3px;
        }

        .chapter-list::-webkit-scrollbar-thumb {
            background: var(--light-gold);
            border-radius: 3px;
        }

        .chapter-list::-webkit-scrollbar-thumb:hover {
            background: var(--rose-gold);
        }

        /* æ¨¡æ€æ¡†æ ·å¼ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .modal.show {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: var(--space-md);
        }

        .modal-content {
            background: var(--ivory-white);
            border-radius: 15px;
            padding: var(--space-lg);
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-md);
            padding-bottom: var(--space-sm);
            border-bottom: 2px solid var(--light-gold);
        }

        .modal-title {
            font-family: 'Ma Shan Zheng', cursive;
            font-size: 24px;
            color: var(--deep-red);
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            color: var(--charcoal);
            cursor: pointer;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .close-btn:hover {
            background: var(--warm-white);
            color: var(--deep-red);
        }
    </style>
</head>
<body>
    <!-- å®Œæˆåº†ç¥åŠ¨ç”» -->
    <div class="completion-celebration" id="completionCelebration">
        <div class="golden-particles"></div>
        <div class="celebration-text">å¤§åŠŸå‘Šæˆï¼</div>
    </div>

    <div class="container">
        <!-- é¡µé¢å¤´éƒ¨ -->
        <header class="header">
            <h1 class="title">ç»å…¸è¯µè¯»</h1>
            <p class="subtitle">å¤éŸµä»Šå£° Â· ä¼ æ‰¿ç»å…¸</p>
        </header>

        <!-- å¯¼èˆªæ ‡ç­¾ -->
        <nav class="nav-tabs">
            <button class="nav-tab active" data-page="books">ğŸ“š æˆ‘çš„ä¹¦ç±</button>
            <button class="nav-tab" data-page="add-book">â• æ·»åŠ ä¹¦ç±</button>
            <button class="nav-tab" data-page="stats">ğŸ“Š ç»Ÿè®¡</button>
            <button class="nav-tab" data-page="backup">ğŸ’¾ å¤‡ä»½</button>
        </nav>

        <!-- ä¹¦ç±åˆ—è¡¨é¡µé¢ -->
        <div class="page active" id="books-page">
            <div id="books-list">
                <!-- åŠ¨æ€ç”Ÿæˆä¹¦ç±å¡ç‰‡ -->
            </div>
        </div>

        <!-- æ·»åŠ ä¹¦ç±é¡µé¢ -->
        <div class="page" id="add-book-page">
            <div class="book-card">
                <h2 class="book-title">ğŸ“– æ·»åŠ æ–°ä¹¦ç±</h2>
                <form id="add-book-form">
                    <div class="form-group">
                        <label class="form-label" for="book-name">ä¹¦ç±åç§°</label>
                        <input type="text" id="book-name" class="form-input" placeholder="è¯·è¾“å…¥ç»å…¸ä¹¦ç±åç§°" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="book-content">ç« èŠ‚å†…å®¹</label>
                        <textarea id="book-content" class="form-input form-textarea" placeholder="è¯·è¾“å…¥ç¬¬ä¸€ç« å†…å®¹...

å¯æ·»åŠ å¤šä¸ªç« èŠ‚ï¼Œç”¨ç©ºè¡Œåˆ†éš”ä¸åŒç« èŠ‚" required></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%;">âœ¨ åˆ›å»ºä¹¦ç±</button>
                </form>
            </div>
        </div>

        <!-- ç»Ÿè®¡é¡µé¢ -->
        <div class="page" id="stats-page">
            <div class="book-card">
                <h2 class="book-title">ğŸ“Š è¯µè¯»ç»Ÿè®¡</h2>
                <div id="stats-content">
                    <!-- åŠ¨æ€ç”Ÿæˆç»Ÿè®¡å†…å®¹ -->
                </div>
            </div>
        </div>

        <!-- å¤‡ä»½é¡µé¢ -->
        <div class="page" id="backup-page">
            <div class="book-card">
                <h2 class="book-title">ğŸ’¾ æ•°æ®å¤‡ä»½</h2>
                <div class="book-actions" style="flex-direction: column; gap: var(--space-md);">
                    <button class="btn btn-primary" onclick="exportData()">ğŸ“¤ å¯¼å‡ºæ•°æ®</button>
                    <input type="file" id="import-file" accept=".json" style="display: none;" onchange="importData(event)">
                    <button class="btn btn-secondary" onclick="document.getElementById('import-file').click()">ğŸ“¥ å¯¼å…¥æ•°æ®</button>
                </div>
            </div>
        </div>

        <!-- ç« èŠ‚é˜…è¯»æ¨¡æ€æ¡† -->
        <div class="modal" id="reading-modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title" id="modal-title">é˜…è¯»ç« èŠ‚</h3>
                    <button class="close-btn" onclick="closeReadingModal()">&times;</button>
                </div>
                <div class="reading-interface">
                    <div class="chapter-header">
                        <h4 class="chapter-title" id="chapter-title"></h4>
                        <div class="chapter-info">
                            <span class="chapter-stat">å·²è¯»: <span id="read-count">0</span>/100 æ¬¡</span>
                            <span class="chapter-stat">è¿›åº¦: <span id="progress-percent">0</span>%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progress-fill" style="width: 0%;"></div>
                        </div>
                    </div>
                    <div class="reading-content">
                        <div class="reading-text" id="chapter-content"></div>
                    </div>
                    <button class="stamp-button" id="stamp-button" onclick="incrementReading()">è¯µè¯»</button>
                    <div class="book-actions" style="justify-content: center; gap: var(--space-md);">
                        <button class="btn btn-secondary" onclick="previousChapter()">â¬…ï¸ ä¸Šä¸€ç« </button>
                        <button class="btn btn-secondary" onclick="nextChapter()">ä¸‹ä¸€ç«  â¡ï¸</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let books = [];
        let currentBook = null;
        let currentChapter = null;
        let currentChapterIndex = 0;

        // é»˜è®¤ç»å…¸ä¹¦ç±æ•°æ®
        const defaultBooks = [
            {
                id: 1,
                name: "è®ºè¯­",
                chapters: [
                    {
                        id: 1,
                        content: "å­¦è€Œæ—¶ä¹ ä¹‹ï¼Œä¸äº¦è¯´ä¹ï¼Ÿæœ‰æœ‹è‡ªè¿œæ–¹æ¥ï¼Œä¸äº¦ä¹ä¹ï¼Ÿäººä¸çŸ¥è€Œä¸æ„ ï¼Œä¸äº¦å›å­ä¹ï¼Ÿ",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 2,
                        content: "å·§è¨€ä»¤è‰²ï¼Œé²œçŸ£ä»ã€‚",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 3,
                        content: "å¼Ÿå­å…¥åˆ™å­ï¼Œå‡ºåˆ™å¼Ÿï¼Œè°¨è€Œä¿¡ï¼Œæ³›çˆ±ä¼—ï¼Œè€Œäº²ä»ã€‚",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 4,
                        content: "å­æ›°ï¼š\"å¾åæœ‰äº”è€Œå¿—äºå­¦ï¼Œä¸‰åè€Œç«‹ï¼Œå››åè€Œä¸æƒ‘ï¼Œäº”åè€ŒçŸ¥å¤©å‘½ï¼Œå…­åè€Œè€³é¡ºï¼Œä¸ƒåè€Œä»å¿ƒæ‰€æ¬²ä¸é€¾çŸ©ã€‚\"",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 5,
                        content: "å­æ›°ï¼š\"æ¸©æ•…è€ŒçŸ¥æ–°ï¼Œå¯ä»¥ä¸ºå¸ˆçŸ£ã€‚\"",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 6,
                        content: "å­æ›°ï¼š\"å­¦è€Œä¸æ€åˆ™ç½”ï¼Œæ€è€Œä¸å­¦åˆ™æ®†ã€‚\"",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 7,
                        content: "å­æ›°ï¼š\"çŸ¥ä¹‹è€…ä¸å¦‚å¥½ä¹‹è€…ï¼Œå¥½ä¹‹è€…ä¸å¦‚ä¹ä¹‹è€…ã€‚\"",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 8,
                        content: "å­æ›°ï¼š\"ä¸‰äººè¡Œï¼Œå¿…æœ‰æˆ‘å¸ˆç„‰ã€‚æ‹©å…¶å–„è€…è€Œä»ä¹‹ï¼Œå…¶ä¸å–„è€…è€Œæ”¹ä¹‹ã€‚\"",
                        readCount: 0,
                        completed: false
                    }
                ],
                stats: {
                    totalChapters: 8,
                    completedChapters: 0,
                    totalReadings: 0,
                    lastRead: null
                }
            },
            {
                id: 2,
                name: "é“å¾·ç»",
                chapters: [
                    {
                        id: 1,
                        content: "é“å¯é“ï¼Œéå¸¸é“ï¼›åå¯åï¼Œéå¸¸åã€‚æ— åå¤©åœ°ä¹‹å§‹ï¼Œæœ‰åä¸‡ç‰©ä¹‹æ¯ã€‚",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 2,
                        content: "å¤©ä¸‹çš†çŸ¥ç¾ä¹‹ä¸ºç¾ï¼Œæ–¯æ¶å·²ï¼›çš†çŸ¥å–„ä¹‹ä¸ºå–„ï¼Œæ–¯ä¸å–„å·²ã€‚",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 3,
                        content: "ä¸Šå–„è‹¥æ°´ã€‚æ°´å–„åˆ©ä¸‡ç‰©è€Œä¸äº‰ï¼Œå¤„ä¼—äººä¹‹æ‰€æ¶ï¼Œæ•…å‡ äºé“ã€‚",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 4,
                        content: "é“ç”Ÿä¸€ï¼Œä¸€ç”ŸäºŒï¼ŒäºŒç”Ÿä¸‰ï¼Œä¸‰ç”Ÿä¸‡ç‰©ã€‚ä¸‡ç‰©è´Ÿé˜´è€ŒæŠ±é˜³ï¼Œå†²æ°”ä»¥ä¸ºå’Œã€‚",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 5,
                        content: "äººæ³•åœ°ï¼Œåœ°æ³•å¤©ï¼Œå¤©æ³•é“ï¼Œé“æ³•è‡ªç„¶ã€‚",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 6,
                        content: "çŸ¥äººè€…æ™ºï¼Œè‡ªçŸ¥è€…æ˜ã€‚èƒœäººè€…æœ‰åŠ›ï¼Œè‡ªèƒœè€…å¼ºã€‚",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 7,
                        content: "åˆæŠ±ä¹‹æœ¨ï¼Œç”Ÿäºæ¯«æœ«ï¼›ä¹å±‚ä¹‹å°ï¼Œèµ·äºç´¯åœŸï¼›åƒé‡Œä¹‹è¡Œï¼Œå§‹äºè¶³ä¸‹ã€‚",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 8,
                        content: "ä¸Šå£«é—»é“ï¼Œå‹¤è€Œè¡Œä¹‹ï¼›ä¸­å£«é—»é“ï¼Œè‹¥å­˜è‹¥äº¡ï¼›ä¸‹å£«é—»é“ï¼Œå¤§ç¬‘ä¹‹ã€‚",
                        readCount: 0,
                        completed: false
                    }
                ],
                stats: {
                    totalChapters: 8,
                    completedChapters: 0,
                    totalReadings: 0,
                    lastRead: null
                }
            },
            {
                id: 3,
                name: "å¤§å­¦",
                chapters: [
                    {
                        id: 1,
                        content: "å¤§å­¦ä¹‹é“ï¼Œåœ¨æ˜æ˜å¾·ï¼Œåœ¨äº²æ°‘ï¼Œåœ¨æ­¢äºè‡³å–„ã€‚",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 2,
                        content: "å¤ä¹‹æ¬²æ˜æ˜å¾·äºå¤©ä¸‹è€…ï¼Œå…ˆæ²»å…¶å›½ï¼›æ¬²æ²»å…¶å›½è€…ï¼Œå…ˆé½å…¶å®¶ï¼›æ¬²é½å…¶å®¶è€…ï¼Œå…ˆä¿®å…¶èº«ã€‚",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 3,
                        content: "ç‰©æ ¼è€ŒåçŸ¥è‡³ï¼ŒçŸ¥è‡³è€Œåæ„è¯šï¼Œæ„è¯šè€Œåå¿ƒæ­£ï¼Œå¿ƒæ­£è€Œåèº«ä¿®ï¼Œèº«ä¿®è€Œåå®¶é½ï¼Œå®¶é½è€Œåå›½æ²»ï¼Œå›½æ²»è€Œåå¤©ä¸‹å¹³ã€‚",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 4,
                        content: "æ‰€è°“è¯šå…¶æ„è€…ï¼Œæ¯‹è‡ªæ¬ºä¹Ÿã€‚å¦‚æ¶æ¶è‡­ï¼Œå¦‚å¥½å¥½è‰²ï¼Œæ­¤ä¹‹è°“è‡ªè°¦ã€‚",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 5,
                        content: "æ‰€è°“ä¿®èº«åœ¨æ­£å…¶å¿ƒè€…ï¼šå¿ƒæœ‰æ‰€å¥½ä¹ï¼Œåˆ™ä¸å¾—å…¶æ­£ï¼›æœ‰æ‰€ææƒ§ï¼Œåˆ™ä¸å¾—å…¶æ­£ï¼›æœ‰æ‰€å¿§æ‚£ï¼Œåˆ™ä¸å¾—å…¶æ­£ã€‚",
                        readCount: 0,
                        completed: false
                    }
                ],
                stats: {
                    totalChapters: 5,
                    completedChapters: 0,
                    totalReadings: 0,
                    lastRead: null
                }
            },
            {
                id: 4,
                name: "ä¸­åº¸",
                chapters: [
                    {
                        id: 1,
                        content: "å¤©å‘½ä¹‹è°“æ€§ï¼Œç‡æ€§ä¹‹è°“é“ï¼Œä¿®é“ä¹‹è°“æ•™ã€‚",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 2,
                        content: "å–œæ€’å“€ä¹ä¹‹æœªå‘ï¼Œè°“ä¹‹ä¸­ï¼›å‘è€Œçš†ä¸­èŠ‚ï¼Œè°“ä¹‹å’Œã€‚",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 3,
                        content: "ä¸­ä¹Ÿè€…ï¼Œå¤©ä¸‹ä¹‹å¤§æœ¬ä¹Ÿï¼›å’Œä¹Ÿè€…ï¼Œå¤©ä¸‹ä¹‹è¾¾é“ä¹Ÿã€‚è‡´ä¸­å’Œï¼Œå¤©åœ°ä½ç„‰ï¼Œä¸‡ç‰©è‚²ç„‰ã€‚",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 4,
                        content: "å›å­ä¸­åº¸ï¼Œå°äººåä¸­åº¸ã€‚å›å­ä¹‹ä¸­åº¸ä¹Ÿï¼Œå›å­è€Œæ—¶ä¸­ï¼›å°äººä¹‹ä¸­åº¸ä¹Ÿï¼Œå°äººè€Œæ— å¿Œå¼¹ä¹Ÿã€‚",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 5,
                        content: "åšå­¦ä¹‹ï¼Œå®¡é—®ä¹‹ï¼Œæ…æ€ä¹‹ï¼Œæ˜è¾¨ä¹‹ï¼Œç¬ƒè¡Œä¹‹ã€‚",
                        readCount: 0,
                        completed: false
                    }
                ],
                stats: {
                    totalChapters: 5,
                    completedChapters: 0,
                    totalReadings: 0,
                    lastRead: null
                }
            },
            {
                id: 5,
                name: "è¯—ç»",
                chapters: [
                    {
                        id: 1,
                        content: "å…³å…³é›é¸ ï¼Œåœ¨æ²³ä¹‹æ´²ã€‚çªˆçª•æ·‘å¥³ï¼Œå›å­å¥½é€‘ã€‚",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 2,
                        content: "è’¹è‘­è‹è‹ï¼Œç™½éœ²ä¸ºéœœã€‚æ‰€è°“ä¼Šäººï¼Œåœ¨æ°´ä¸€æ–¹ã€‚",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 3,
                        content: "å½¼é»ç¦»ç¦»ï¼Œå½¼ç¨·ä¹‹è‹—ã€‚è¡Œè¿ˆé¡é¡ï¼Œä¸­å¿ƒæ‘‡æ‘‡ã€‚",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 4,
                        content: "æŠ•æˆ‘ä»¥æœ¨æ¡ƒï¼ŒæŠ¥ä¹‹ä»¥ç¼ç‘¶ã€‚åŒªæŠ¥ä¹Ÿï¼Œæ°¸ä»¥ä¸ºå¥½ä¹Ÿã€‚",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 5,
                        content: "å¦‚æœˆä¹‹æ’ï¼Œå¦‚æ—¥ä¹‹å‡ã€‚å¦‚å—å±±ä¹‹å¯¿ï¼Œä¸éªä¸å´©ã€‚",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 6,
                        content: "é‡‡è–‡é‡‡è–‡ï¼Œè–‡äº¦ä½œæ­¢ã€‚æ›°å½’æ›°å½’ï¼Œå²äº¦è«æ­¢ã€‚",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 7,
                        content: "é’é’å­è¡¿ï¼Œæ‚ æ‚ æˆ‘å¿ƒã€‚çºµæˆ‘ä¸å¾€ï¼Œå­å®ä¸å—£éŸ³ï¼Ÿ",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 8,
                        content: "é£é›¨å¦‚æ™¦ï¼Œé¸¡é¸£ä¸å·²ã€‚æ—¢è§å›å­ï¼Œäº‘èƒ¡ä¸å–œï¼Ÿ",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 9,
                        content: "æ¡ƒä¹‹å¤­å¤­ï¼Œç¼ç¼å…¶åã€‚ä¹‹å­äºå½’ï¼Œå®œå…¶å®¤å®¶ã€‚",
                        readCount: 0,
                        completed: false
                    },
                    {
                        id: 10,
                        content: "å¦‚åˆ‡å¦‚ç£‹ï¼Œå¦‚ç¢å¦‚ç£¨ã€‚å¦‚åˆ‡å¦‚ç£‹è€…ï¼Œé“å­¦ä¹Ÿï¼›å¦‚ç¢å¦‚ç£¨è€…ï¼Œè‡ªä¿®ä¹Ÿã€‚",
                        readCount: 0,
                        completed: false
                    }
                ],
                stats: {
                    totalChapters: 10,
                    completedChapters: 0,
                    totalReadings: 0,
                    lastRead: null
                }
            }
        ];

        // åˆå§‹åŒ–åº”ç”¨
        function initApp() {
            loadBooks();
            renderBooksList();
            setupEventListeners();
            updateStats();
        }

        // åŠ è½½ä¹¦ç±æ•°æ®
        function loadBooks() {
            const savedBooks = localStorage.getItem('classicalReadingBooks');
            if (savedBooks) {
                books = JSON.parse(savedBooks);
            } else {
                // é¦–æ¬¡ä½¿ç”¨ï¼Œåˆå§‹åŒ–é»˜è®¤ä¹¦ç±
                books = JSON.parse(JSON.stringify(defaultBooks));
                saveBooks();
            }
        }

        // ä¿å­˜ä¹¦ç±æ•°æ®
        function saveBooks() {
            localStorage.setItem('classicalReadingBooks', JSON.stringify(books));
        }

        // è®¡ç®—ä¹¦ç±ç»Ÿè®¡
        function updateBookStats(book) {
            const totalChapters = book.chapters.length;
            const completedChapters = book.chapters.filter(ch => ch.completed).length;
            const totalReadings = book.chapters.reduce((sum, ch) => sum + ch.readCount, 0);
            const lastRead = book.chapters
                .filter(ch => ch.readCount > 0)
                .sort((a, b) => new Date(b.lastRead) - new Date(a.lastRead))[0]?.lastRead || null;

            book.stats = {
                totalChapters,
                completedChapters,
                totalReadings,
                lastRead
            };
        }

        // æ¸²æŸ“ä¹¦ç±åˆ—è¡¨
        function renderBooksList() {
            const container = document.getElementById('books-list');
            container.innerHTML = '';

            if (books.length === 0) {
                container.innerHTML = `
                    <div class="book-card">
                        <p style="text-align: center; color: var(--charcoal); padding: 2rem;">
                            æš‚æ— ä¹¦ç±ï¼Œè¯·å…ˆæ·»åŠ ä¹¦ç±
                        </p>
                    </div>
                `;
                return;
            }

            books.forEach(book => {
                updateBookStats(book);
                const completionRate = book.stats.totalChapters > 0 ? 
                    Math.round((book.stats.completedChapters / book.stats.totalChapters) * 100) : 0;

                const card = document.createElement('div');
                card.className = 'book-card';
                card.innerHTML = `
                    <h3 class="book-title">
                        <span>ğŸ“š</span>
                        <span>${book.name}</span>
                    </h3>
                    <div class="book-stats">
                        <span class="stat-item">æ€»ç« èŠ‚: ${book.stats.totalChapters}</span>
                        <span class="stat-item">å·²å®Œæˆ: ${book.stats.completedChapters}</span>
                        <span class="stat-item">æ€»è¯»æ•°: ${book.stats.totalReadings}</span>
                        <span class="stat-item">å®Œæˆç‡: ${completionRate}%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${completionRate}%;"></div>
                    </div>
                    <div class="book-actions">
                        <button class="btn btn-primary" onclick="openBook('${book.id}')">ğŸ“– å¼€å§‹é˜…è¯»</button>
                        <button class="btn btn-secondary" onclick="deleteBook('${book.id}')">ğŸ—‘ï¸ åˆ é™¤</button>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // æ‰“å¼€ä¹¦ç±
        function openBook(bookId) {
            currentBook = books.find(b => b.id == bookId);
            if (!currentBook) return;

            // åˆ›å»ºç« èŠ‚é€‰æ‹©æ¨¡æ€æ¡†
            showChapterSelection(currentBook);
        }

        // æ˜¾ç¤ºç« èŠ‚é€‰æ‹©
        function showChapterSelection(book) {
            const modal = document.createElement('div');
            modal.className = 'modal show';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h3 class="modal-title">é€‰æ‹©ç« èŠ‚ - ${book.name}</h3>
                        <button class="close-btn" onclick="this.closest('.modal').remove()">&times;</button>
                    </div>
                    <div class="chapter-list">
                        ${book.chapters.map((chapter, index) => `
                            <div class="chapter-item ${chapter.completed ? 'completed' : ''}" 
                                 onclick="openChapter(${book.id}, ${chapter.id})">
                                <span class="chapter-name">ç¬¬${index + 1}ç« </span>
                                <span class="chapter-count">${chapter.readCount}/100</span>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        // æ‰“å¼€ç« èŠ‚
        function openChapter(bookId, chapterId) {
            currentBook = books.find(b => b.id == bookId);
            currentChapter = currentBook.chapters.find(c => c.id == chapterId);
            currentChapterIndex = currentBook.chapters.findIndex(c => c.id == chapterId);

            // å…³é—­ç« èŠ‚é€‰æ‹©æ¨¡æ€æ¡†
            document.querySelectorAll('.modal').forEach(modal => modal.remove());

            // æ˜¾ç¤ºé˜…è¯»æ¨¡æ€æ¡†
            showReadingModal();
        }

        // æ˜¾ç¤ºé˜…è¯»æ¨¡æ€æ¡†
        function showReadingModal() {
            const modal = document.getElementById('reading-modal');
            const chapterTitle = document.getElementById('chapter-title');
            const chapterContent = document.getElementById('chapter-content');
            const readCount = document.getElementById('read-count');
            const progressPercent = document.getElementById('progress-percent');
            const progressFill = document.getElementById('progress-fill');

            chapterTitle.textContent = `${currentBook.name} - ç¬¬${currentChapterIndex + 1}ç« `;
            chapterContent.textContent = currentChapter.content;
            readCount.textContent = currentChapter.readCount;
            
            const percent = Math.round((currentChapter.readCount / 100) * 100);
            progressPercent.textContent = percent;
            progressFill.style.width = `${percent}%`;

            modal.classList.add('show');
        }

        // å…³é—­é˜…è¯»æ¨¡æ€æ¡†
        function closeReadingModal() {
            document.getElementById('reading-modal').classList.remove('show');
            renderBooksList();
            saveBooks();
        }

        // å¢åŠ é˜…è¯»æ¬¡æ•°
        function incrementReading() {
            if (currentChapter.readCount < 100) {
                currentChapter.readCount++;
                currentChapter.lastRead = new Date().toISOString();
                
                // æ£€æŸ¥æ˜¯å¦å®Œæˆ
                if (currentChapter.readCount >= 100) {
                    currentChapter.completed = true;
                    showCompletionCelebration();
                }

                // æ›´æ–°æ˜¾ç¤º
                document.getElementById('read-count').textContent = currentChapter.readCount;
                const percent = Math.round((currentChapter.readCount / 100) * 100);
                document.getElementById('progress-percent').textContent = percent;
                document.getElementById('progress-fill').style.width = `${percent}%`;

                // å°ç« æŒ‰é’®åŠ¨ç”»æ•ˆæœ
                const button = document.getElementById('stamp-button');
                button.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    button.style.transform = 'scale(1)';
                }, 150);

                saveBooks();
            }
        }

        // æ˜¾ç¤ºå®Œæˆåº†ç¥åŠ¨ç”»
        function showCompletionCelebration() {
            const celebration = document.getElementById('completionCelebration');
            celebration.classList.add('show');
            
            setTimeout(() => {
                celebration.classList.remove('show');
            }, 3000);
        }

        // ä¸Šä¸€ç« 
        function previousChapter() {
            if (currentChapterIndex > 0) {
                currentChapterIndex--;
                currentChapter = currentBook.chapters[currentChapterIndex];
                showReadingModal();
            }
        }

        // ä¸‹ä¸€ç« 
        function nextChapter() {
            if (currentChapterIndex < currentBook.chapters.length - 1) {
                currentChapterIndex++;
                currentChapter = currentBook.chapters[currentChapterIndex];
                showReadingModal();
            }
        }

        // åˆ é™¤ä¹¦ç±
        function deleteBook(bookId) {
            if (confirm('ç¡®å®šè¦åˆ é™¤è¿™æœ¬ä¹¦å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚')) {
                books = books.filter(b => b.id != bookId);
                saveBooks();
                renderBooksList();
            }
        }

        // æ·»åŠ ä¹¦ç±
        function addBook(name, content) {
            const chapters = content.split('\n\n').filter(ch => ch.trim()).map((ch, index) => ({
                id: Date.now() + index,
                content: ch.trim(),
                readCount: 0,
                completed: false
            }));

            const book = {
                id: Date.now(),
                name: name,
                chapters: chapters,
                stats: {
                    totalChapters: chapters.length,
                    completedChapters: 0,
                    totalReadings: 0,
                    lastRead: null
                }
            };

            books.push(book);
            saveBooks();
            renderBooksList();

            // æ¸…ç©ºè¡¨å•
            document.getElementById('book-name').value = '';
            document.getElementById('book-content').value = '';

            // åˆ‡æ¢åˆ°ä¹¦ç±åˆ—è¡¨é¡µ
            switchPage('books');
        }

        // å¯¼å‡ºæ•°æ®
        function exportData() {
            const data = {
                books: books,
                exportTime: new Date().toISOString(),
                version: "1.0"
            };

            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `classical-reading-backup-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // å¯¼å…¥æ•°æ®
        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    if (data.books && Array.isArray(data.books)) {
                        if (confirm('å¯¼å…¥æ•°æ®å°†è¦†ç›–å½“å‰æ‰€æœ‰æ•°æ®ï¼Œç¡®å®šè¦ç»§ç»­å—ï¼Ÿ')) {
                            books = data.books;
                            saveBooks();
                            renderBooksList();
                            alert('æ•°æ®å¯¼å…¥æˆåŠŸï¼');
                        }
                    } else {
                        alert('æ–‡ä»¶æ ¼å¼ä¸æ­£ç¡®ï¼');
                    }
                } catch (error) {
                    alert('æ–‡ä»¶è§£æå¤±è´¥ï¼');
                }
            };
            reader.readAsText(file);
        }

        // æ›´æ–°ç»Ÿè®¡é¡µé¢
        function updateStats() {
            const statsContent = document.getElementById('stats-content');
            
            const totalBooks = books.length;
            const totalChapters = books.reduce((sum, book) => sum + book.chapters.length, 0);
            const totalReadings = books.reduce((sum, book) => 
                sum + book.chapters.reduce((chSum, ch) => chSum + ch.readCount, 0), 0);
            const completedChapters = books.reduce((sum, book) => 
                sum + book.chapters.filter(ch => ch.completed).length, 0);

            statsContent.innerHTML = `
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number">${totalBooks}</div>
                        <div class="stat-label">æ€»ä¹¦ç±æ•°</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${totalChapters}</div>
                        <div class="stat-label">æ€»ç« èŠ‚æ•°</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${totalReadings}</div>
                        <div class="stat-label">æ€»é˜…è¯»æ¬¡æ•°</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${completedChapters}</div>
                        <div class="stat-label">å·²å®Œæˆç« èŠ‚</div>
                    </div>
                </div>
                
                <h3 style="color: var(--deep-red); margin: 2rem 0 1rem; font-family: 'Ma Shan Zheng', cursive;">
                    ğŸ“ˆ æœ€è¿‘é˜…è¯»è®°å½•
                </h3>
                <div id="recent-readings" style="max-height: 300px; overflow-y: auto;">
                    <!-- åŠ¨æ€ç”Ÿæˆæœ€è¿‘é˜…è¯»è®°å½• -->
                </div>
            `;

            // ç”Ÿæˆæœ€è¿‘é˜…è¯»è®°å½•
            const recentReadings = [];
            books.forEach(book => {
                book.chapters.forEach(chapter => {
                    if (chapter.readCount > 0) {
                        recentReadings.push({
                            bookName: book.name,
                            chapterIndex: book.chapters.findIndex(c => c.id === chapter.id) + 1,
                            readCount: chapter.readCount,
                            lastRead: chapter.lastRead
                        });
                    }
                });
            });

            recentReadings.sort((a, b) => new Date(b.lastRead) - new Date(a.lastRead));
            
            const recentContainer = document.getElementById('recent-readings');
            if (recentReadings.length === 0) {
                recentContainer.innerHTML = `
                    <div style="text-align: center; color: var(--charcoal); padding: 2rem;">
                        æš‚æ— é˜…è¯»è®°å½•
                    </div>
                `;
            } else {
                recentContainer.innerHTML = recentReadings.slice(0, 10).map(reading => `
                    <div style="padding: 1rem; border-bottom: 1px solid var(--light-gold); display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <strong style="color: var(--deep-red);">${reading.bookName}</strong>
                            <span style="color: var(--charcoal); margin-left: 0.5rem;">ç¬¬${reading.chapterIndex}ç« </span>
                        </div>
                        <div style="text-align: right;">
                            <div style="color: var(--soft-green); font-weight: bold;">${reading.readCount}/100</div>
                            <div style="color: var(--charcoal); font-size: 12px;">
                                ${new Date(reading.lastRead).toLocaleDateString()}
                            </div>
                        </div>
                    </div>
                `).join('');
            }
        }

        // åˆ‡æ¢é¡µé¢
        function switchPage(pageId) {
            // éšè—æ‰€æœ‰é¡µé¢
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // ç§»é™¤æ‰€æœ‰å¯¼èˆªæ ‡ç­¾çš„activeçŠ¶æ€
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // æ˜¾ç¤ºç›®æ ‡é¡µé¢
            document.getElementById(pageId + '-page').classList.add('active');
            
            // æ¿€æ´»å¯¹åº”çš„å¯¼èˆªæ ‡ç­¾
            document.querySelector(`[data-page="${pageId}"]`).classList.add('active');
            
            // å¦‚æœåˆ‡æ¢åˆ°ç»Ÿè®¡é¡µé¢ï¼Œæ›´æ–°ç»Ÿè®¡
            if (pageId === 'stats') {
                updateStats();
            }
        }

        // è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
        function setupEventListeners() {
            // å¯¼èˆªæ ‡ç­¾ç‚¹å‡»
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.addEventListener('click', (e) => {
                    const pageId = e.target.getAttribute('data-page');
                    switchPage(pageId);
                });
            });

            // æ·»åŠ ä¹¦ç±è¡¨å•æäº¤
            document.getElementById('add-book-form').addEventListener('submit', (e) => {
                e.preventDefault();
                const name = document.getElementById('book-name').value.trim();
                const content = document.getElementById('book-content').value.trim();
                
                if (name && content) {
                    addBook(name, content);
                }
            });

            // é”®ç›˜å¿«æ·é”®
            document.addEventListener('keydown', (e) => {
                // ç©ºæ ¼é”®è§¦å‘å°ç« 
                if (e.code === 'Space' && document.getElementById('reading-modal').classList.contains('show')) {
                    e.preventDefault();
                    incrementReading();
                }
                
                // ESCé”®å…³é—­æ¨¡æ€æ¡†
                if (e.code === 'Escape') {
                    document.querySelectorAll('.modal').forEach(modal => {
                        modal.classList.remove('show');
                    });
                }
            });

            // æ¨¡æ€æ¡†èƒŒæ™¯ç‚¹å‡»å…³é—­
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.classList.remove('show');
                    }
                });
            });
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>